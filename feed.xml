<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>慎独</title>
    <description>博学之，审问之，慎思之，明辨之，笃行之
</description>
    <link>http://sleefd.github.io/newblog/</link>
    <atom:link href="http://sleefd.github.io/newblog/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Thu, 08 Oct 2015 17:10:52 +0800</pubDate>
    <lastBuildDate>Thu, 08 Oct 2015 17:10:52 +0800</lastBuildDate>
    <generator>Jekyll v2.5.3</generator>
    
      <item>
        <title>是否需要在log信息之前checkXXXEnabled</title>
        <description>&lt;p&gt;项目中经常需要log日志，有人直接log.debug(),有人在log日志
之前会进行检查log.isDebugEnabled()，而我则习惯采用第一种做法，
因为简便。那log之前检查对应级别是否开启有必要吗？&lt;/p&gt;

&lt;p&gt;其实是有必要的。表面上看直接log.debug只进行了一次enable检查，但若之前
加上log.isXXEnabled()则会进行两次enabled检查，是否多此一举呢？其实不然，
如果不进行enabled检查，直接log.debug，如果log的message存在复杂操作比如
字符串连接或object.toString等，那么根据参数先进行计算的原则，enable
检查之前会进行复杂不必要的字符串运算增加开销，但若之前已经进行了检查
就不会有此开销。&lt;/p&gt;

&lt;p&gt;使用log4j1.x，log之前都需进行log.isXXXEnabled检查，但若使用log4j2.x，则
可采用log.debug(“divide by {}”， num)，这种新的接口输出信息，不会在level检查
之前进行额外计算。&lt;/p&gt;

&lt;h4 id=&quot;section&quot;&gt;参考&lt;/h4&gt;

&lt;p&gt;&lt;a href=&quot;http://stackoverflow.com/questions/963492/in-log4j-does-checking-isdebugenabled-before-logging-improve-performance&quot;&gt;stackoverflow&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://logging.apache.org/log4j/2.0/manual/api.html&quot;&gt;log4j2 api&lt;/a&gt;&lt;/p&gt;

</description>
        <pubDate>Wed, 30 Sep 2015 11:06:00 +0800</pubDate>
        <link>http://sleefd.github.io/newblog/learn/2015/09/30/why-check-log-enabled.html</link>
        <guid isPermaLink="true">http://sleefd.github.io/newblog/learn/2015/09/30/why-check-log-enabled.html</guid>
        
        
        <category>learn</category>
        
      </item>
    
      <item>
        <title>tomcat远程调试</title>
        <description>&lt;p&gt;若tomcat服务器安装在远程主机，web应用出现了问题，通常需要远程调试来解决。&lt;/p&gt;

&lt;p&gt;远程调试不用在本地模拟生产环境，只需要远程服务器开启debug模式，本地连上
服务器的监听端口即可调试，且需具备与远程服务器相同的代码。&lt;/p&gt;

&lt;p&gt;连接上远程服务器后，直接在本地代码断点，即可达到与本地断点调试相同的效果。&lt;/p&gt;

&lt;p&gt;tomcat远程调试非常简单，将start.sh最后一行启动代码改为&lt;code&gt;exec &quot;$PRGDIR&quot;/&quot;$EXECUTABLE&quot; jpda start &quot;$@&quot;&lt;/code&gt;即可，
默认会开启8000端口监听连接或直接命令行执行&lt;code&gt;catalina.sh jpda start&lt;/code&gt;。&lt;/p&gt;

&lt;p&gt;端口定义在catalina.sh中，可通过修改JPDA_ADDRESS来修改监听端口号。&lt;/p&gt;

&lt;p&gt;使用intellij idea，可Edit configuration，然后选择remote或tomcat server remote配置项，
接着在Host和Port中分别填上ip地址与监听端口号，即可开始连接远程服务器进行调试。&lt;/p&gt;

</description>
        <pubDate>Sat, 19 Sep 2015 22:39:00 +0800</pubDate>
        <link>http://sleefd.github.io/newblog/learn/2015/09/19/tomcat-remote-debug.html</link>
        <guid isPermaLink="true">http://sleefd.github.io/newblog/learn/2015/09/19/tomcat-remote-debug.html</guid>
        
        
        <category>learn</category>
        
      </item>
    
      <item>
        <title>log4j 1.x一瞥</title>
        <description>&lt;p&gt;log4j，常用的日志库，用的很多但并不是特别了解，因此细学习了官方文档，
以便日后使用时不会有所困惑。&lt;/p&gt;

&lt;p&gt;log4j有四个重要的概念：logger,level,appender,layout，了解这四个基本概念
就能知道如何使用log4j.&lt;/p&gt;

&lt;h4 id=&quot;logger&quot;&gt;logger&lt;/h4&gt;
&lt;p&gt;logger负责输出日志，可调用info/debug等方法输出不同级别的日志。不同的方法对应
不同的级别请求，比如调用info则输出info级别的日志。&lt;/p&gt;

&lt;p&gt;logger之间有存在继承关系，如果logger没定义级别，则继承父亲所定义的级别，RootLogger是所有logger的基类。&lt;/p&gt;

&lt;h4 id=&quot;level&quot;&gt;level&lt;/h4&gt;
&lt;p&gt;级别用于分级显示日志，不同级别输出不同的日志内容。级别请求相比于logger级别高则会输出。级别从低到高排序如下：
  trace&amp;lt;info&amp;lt;debug&amp;lt;warn&amp;lt;error&amp;lt;fatal，因此级别若设置为trace,则所有的log请求都会输出。&lt;/p&gt;

&lt;h4 id=&quot;appender&quot;&gt;appender&lt;/h4&gt;
&lt;p&gt;appender用于定义日志的输出位置，可以是console, 可以是文件，也可以是远程socket等。且可定义
多个，则会同时输出到多个位置。&lt;/p&gt;

&lt;h4 id=&quot;layout&quot;&gt;layout&lt;/h4&gt;
&lt;p&gt;layout用于定义输出的日志格式，由格式化字符串指定。&lt;/p&gt;

&lt;h4 id=&quot;section&quot;&gt;使用&lt;/h4&gt;
&lt;p&gt;可直接在代码中定义logger，也可以由log4j.properties配置文件配置logger。&lt;/p&gt;

&lt;h4 id=&quot;demo&quot;&gt;demo&lt;/h4&gt;
&lt;p&gt;log4j.properties配置文件&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;log4j.rootLogger=INFO,console
log4j.appender.console=org.apache.log4j.ConsoleAppender
log4j.appender.console.layout=org.apache.log4j.PatternLayout
log4j.appender.console.ConversionPattern=%-4r [%t] %-5p %c %x - %m%n&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

</description>
        <pubDate>Sat, 19 Sep 2015 22:14:00 +0800</pubDate>
        <link>http://sleefd.github.io/newblog/learn/2015/09/19/log4j.html</link>
        <guid isPermaLink="true">http://sleefd.github.io/newblog/learn/2015/09/19/log4j.html</guid>
        
        
        <category>learn</category>
        
      </item>
    
      <item>
        <title>使用Gson解析json字符串</title>
        <description>&lt;p&gt;Gson是google开发的json序列化与反序列化开源lib,个人觉得相比于其他json解析库比如jackson与Java内置的JSONObject都好用。
正好工作中有用到，因此仔细看了Gson官方文档，并总结如下。&lt;/p&gt;

&lt;p&gt;gson object是无状态的，一个gson object可以重复使用，gson提供了
一些有用的工厂方法来进行序列化与反序列化。&lt;/p&gt;

&lt;h4 id=&quot;simple-object-&quot;&gt;simple object 序列化与反序列化&lt;/h4&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span class=&quot;n&quot;&gt;Gson&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gson&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Gson&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;gson&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toJson&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//primitive,class，connection都支持&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;gson&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;fromJson&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h4 id=&quot;section&quot;&gt;泛型反序列化&lt;/h4&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span class=&quot;n&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Student&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;students&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Lists&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;newArrayList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;student1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;student2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;gson&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toJson&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//get a json array with json object&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;Type&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;studentListType&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TypeToken&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Student&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;(){}.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getType&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;//store generical type&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Student&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;studentsList&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gson&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;fromJson&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;studentListType&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;gson&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;fromJson&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h4 id=&quot;json&quot;&gt;解析复杂复合json对象&lt;/h4&gt;

&lt;p&gt;parse json字符串得到columns的所有name值.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span class=&quot;cm&quot;&gt;/** three methods to parse above json string */&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;json&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;{\&amp;quot;name\&amp;quot;:\&amp;quot;slee\&amp;quot;,\&amp;quot;columns\&amp;quot;:[{\&amp;quot;name\&amp;quot;:\&amp;quot;a\&amp;quot;,\&amp;quot;type\&amp;quot;:\&amp;quot;int\&amp;quot;},{\&amp;quot;name\&amp;quot;:\&amp;quot;b\&amp;quot;,\&amp;quot;type\&amp;quot;:\&amp;quot;int\&amp;quot;}]}&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;//use fromJson and toJson&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Gson&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gson&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Gson&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;HashMap&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;map&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gson&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;fromJson&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HashMap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;jsonArray&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gson&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toJson&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;columns&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ArrayList&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;list&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gson&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;fromJson&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jsonArray&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ArrayList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Object&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;obj:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//no need to defined specified class, use object  ok&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;map&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gson&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;fromJson&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HashMap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;name&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;//use gson streaming api, hard to use, need to be very careful&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;InputStream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inputStream&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;ByteArrayInputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getBytes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;JsonReader&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;JsonReader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;InputStreamReader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;beginObject&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;hasNext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()){&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;nextName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;equals&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;columns&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)){&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;readArray&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;//parse column array&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;skipValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//skip no use values，essential&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;endObject&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;readArray&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;JsonReader&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IOException&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// json array handler&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;beginArray&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;hasNext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()){&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;beginObject&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;hasNext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()){&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;nextName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;equals&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;name&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
	    &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;nextString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
	    &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;skipValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;endObject&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;endArray&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;//use gson tree api&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;JsonParser&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;parser&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;JsonParser&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;JsonElement&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;element&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;parser&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;parse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;JsonArray&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;element&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getAsJsonObject&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getAsJsonArray&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;columns&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;JsonElement&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;jsonElement&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jsonElement&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getAsJsonObject&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;name&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getAsString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;参考：&lt;a href=&quot;http://www.studytrails.com/java/json/java-google-json-introduction.jsp&quot;&gt;Gson introduction&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Wed, 09 Sep 2015 20:58:00 +0800</pubDate>
        <link>http://sleefd.github.io/newblog/learn/2015/09/09/gson-usage.html</link>
        <guid isPermaLink="true">http://sleefd.github.io/newblog/learn/2015/09/09/gson-usage.html</guid>
        
        
        <category>learn</category>
        
      </item>
    
      <item>
        <title>git问题again</title>
        <description>&lt;p&gt;最近又遇到两个git相关的问题，记录在此。&lt;/p&gt;

&lt;p&gt;问题1，amend commit之后无法再次push到remote&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;git commit
git push remote branch
&lt;span class=&quot;c&quot;&gt;### modify something&lt;/span&gt;
git commit --amend	
git push remote branch &lt;span class=&quot;c&quot;&gt;# failed&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;push失败是由于同一个commit但内容不同造成的，
如果这个repo只有你一个人开发，可以强制push:
&lt;code&gt;git -f push remote branch&lt;/code&gt;.
否则可采取比较dirty的做法，删掉remote branch,
重新push上去.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;git push remote branch :branch &lt;span class=&quot;c&quot;&gt;#delete remote branch&lt;/span&gt;
git push remote branch  &lt;span class=&quot;c&quot;&gt;# recreate remote branch&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;问题2：如何获取remote新增的branch&lt;/p&gt;

&lt;p&gt;情况是这样的，fork了一个remote repo，开始只有一个branch，
然后remote新增了一个branch，如何获取这个新增的branch，
可以先fetch，然后checkout新branch，再push到自己的remote就可以了。&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;git fetch upstream &lt;span class=&quot;c&quot;&gt;# get new added branch&lt;/span&gt;
git remote -v &lt;span class=&quot;c&quot;&gt;# upstream/newbranch&lt;/span&gt;
git checkout newbranch  &lt;span class=&quot;c&quot;&gt;# get the fetched newbrach&lt;/span&gt;
git push yourremote newbranch&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

</description>
        <pubDate>Wed, 09 Sep 2015 19:46:00 +0800</pubDate>
        <link>http://sleefd.github.io/newblog/learn/2015/09/09/git-problem.html</link>
        <guid isPermaLink="true">http://sleefd.github.io/newblog/learn/2015/09/09/git-problem.html</guid>
        
        
        <category>learn</category>
        
      </item>
    
      <item>
        <title>win下local模式运行hadoop作业</title>
        <description>&lt;p&gt;之前测试mr算法，都是通过写MRUnit来测试map或reduce逻辑完成(通过MiniYarnCluster或MiniMRYarnCluster来做测试更可靠，MRUnit测试非常有限)。然后在单元测试没问题后，
整个算法打fatjar放到集群上运行来保证正确性。&lt;/p&gt;

&lt;p&gt;但fatjar较大，打一个fatjar包需花费大量时间，并且每次修改都要重新打fatjar，而且还要上传到集群测试非常麻烦，所以
考虑以hadoop local模式运行mr算法, 无需打jar包，直接运行本地小量数据，测试算法正确性，非常方便。&lt;/p&gt;

&lt;p&gt;要想在win下以local模式运行hadoop作业，必须在win下重新编译native hadoop, 否则直接下载的官方安装包，在运行过程中会
因为缺少winutils.exe、dll、lib等native libraries报错。出现以下错误都是由于缺少这些包：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span class=&quot;n&quot;&gt;ERROR&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;util&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Shell&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Shell&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;java&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getWinUtilsPath&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;303&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Failed&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;locate&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;the&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;winutils&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;binary&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;the&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hadoop&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;binary&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;java&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;IOException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Could&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;locate&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;executable&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bin&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;winutils&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;exe&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;the&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Hadoop&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;binaries&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;thread&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;main&amp;quot;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;java&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;lang&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;NullPointerException&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;at&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;java&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;lang&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;ProcessBuilder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ProcessBuilder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;java&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1012&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;at&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;org&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;apache&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;hadoop&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;util&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Shell&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;runCommand&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Shell&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;java&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;404&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;     &lt;span class=&quot;n&quot;&gt;at&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;因此第一步是win下编译hadoop，可参见hadoop官方文档，有说明如何基于win平台编译hadoop。
编译成功后，相比于官方提供的安装包，bin目录下会多了winuitls.exe, hadoop.dll等文件，
这就是我们所需要的。&lt;/p&gt;

&lt;p&gt;第二步配置环境变量HADOOP_HOME为hadoop位置。&lt;/p&gt;

&lt;p&gt;第三步直接运行算法，会启动hadoop local_job。
可在工程中加入log4j配置，开启debug模式，这样在作业运行过程中就可以看到hadoop
输出的一些日志信息便于调试。（注：在工程中加入log4j配置文件，是调试开源项目非常好的手段，
有时候没有这些日志完全不知道错误出在哪里）。&lt;/p&gt;

&lt;p&gt;local模式下job的输入输出绝对路径是以工程所在磁盘为根目录，相对路径是以项目位置为根目录。&lt;/p&gt;

&lt;p&gt;比如绝对路径/user/root/test对应为disk:/user/root/test,相对路径root/text则对应disk:/yourproject/root/test,
其中disk为项目所在磁盘。&lt;/p&gt;

</description>
        <pubDate>Mon, 31 Aug 2015 14:24:00 +0800</pubDate>
        <link>http://sleefd.github.io/newblog/bigdata/2015/08/31/run-hadoop-local-mode.html</link>
        <guid isPermaLink="true">http://sleefd.github.io/newblog/bigdata/2015/08/31/run-hadoop-local-mode.html</guid>
        
        
        <category>bigdata</category>
        
      </item>
    
      <item>
        <title>git fork工作流</title>
        <description>&lt;p&gt;项目代码库开始和gerrit关联，用gerrit做code review，然后又突然换成自建的gitlab，
然后就有了这篇文章.&lt;/p&gt;

&lt;p&gt;换成gitlab之后，需要以fork/pull request的方式提交代码,code review，因此
有必要了解git fork工作流.
(zz: gitlab-&amp;gt;gitlab-&amp;gt;gerrit-gitlab，这样换来换去有意思吗,呵呵,遇到commit问题，从来不想着方法去解决，而是更换版本控制工具也是醉了)&lt;/p&gt;

&lt;p&gt;首先fork central repo，这样自己的gitlab projects下就多了一个central repo的副本，后续的提交都应该提交到每个人自己的repo，
而不能提交到central repo. 这也是fork工作流的好处，控制central repo的访问权限，不会有任何人的commits污染整个项目.&lt;/p&gt;

&lt;p&gt;其次, 我的本地仓库在gerrit时代已经有了，上面也包含几个我正在开发新特性的分支，所以不可能clone我的gitlab repo重新开发。
因此第一步需要更换master branch的remote为新gitlab仓库的地址. 有两种方法:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;# add remote and modify master branch&amp;#39;s remote to the new remote&lt;/span&gt;
git remote add gitlab repo-git-url 
git config branch.master.remote  gitlab

&lt;span class=&quot;c&quot;&gt;# or change old remote url directly, suppose origin the old remote&lt;/span&gt;
git remote &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;-url origin repo-git-url&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;这样后续push可以直接到gitlab上的repo里，而remote对应的也是master分支，不会
出现your head is ahead of master xx commits这种提示.&lt;/p&gt;

&lt;p&gt;然后后续开发还是以分支开发的形式就行，每个新特性开发对应一个branch, 单独在这个branch  &lt;br /&gt;
commit代码.&lt;/p&gt;

&lt;p&gt;然后怎么code review呢,发pull request就行了，俗称pr.
gitlab是merge request，github是pull request。
选择自己项目的分支以及central对应的分支名称，@相关人员就ok了。&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;有感：怎么样的环境就有什么样的坑爹事情发生，爱咋地咋地.&lt;/p&gt;
</description>
        <pubDate>Fri, 28 Aug 2015 17:28:00 +0800</pubDate>
        <link>http://sleefd.github.io/newblog/learn/2015/08/28/mod-git-remote.html</link>
        <guid isPermaLink="true">http://sleefd.github.io/newblog/learn/2015/08/28/mod-git-remote.html</guid>
        
        
        <category>learn</category>
        
      </item>
    
      <item>
        <title>win下sqoop1.99.6编译</title>
        <description>&lt;p&gt;sqoop使用maven进行项目构建，所以按照maven的构建方式编译源码即可，
官网也有说明编译步骤。&lt;/p&gt;

&lt;p&gt;编译过程中遇到一些小问题，一并记录在次。&lt;/p&gt;

&lt;h3 id=&quot;section&quot;&gt;下载源码&lt;/h3&gt;
&lt;p&gt;clone github上sqoop的源码，可以看到很多分支，现在working的sqoop分支是sqoop2，
因为要编译1.99.6，所以直接checkout branch-1.99.6&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;git clone https://github.com/apache/sqoop.git
git branch -a &lt;span class=&quot;c&quot;&gt;# show all the branches&lt;/span&gt;
git checkout branch-1.99.6&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;section-1&quot;&gt;编译源码&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;mvn compile -DskipTests &lt;span class=&quot;c&quot;&gt;# compile, skip tests, fast compile speed&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;编译到common包，执行saveVersion.sh遇到问题&lt;strong&gt;invalid escape character \&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;saveVersion.sh生成package-info.java文件中的注解。
打开生成的package-info.java一开，发现user字符串的内容为”slee\sleefd”,
显然在java中是非法字符串，可以改为&lt;code&gt;\\&lt;/code&gt;或直接改为&lt;code&gt;/&lt;/code&gt;即可,继续
编译ok。&lt;/p&gt;

&lt;h3 id=&quot;section-2&quot;&gt;打包发布&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;mvn package -Dbinary -DskipTests&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;section-3&quot;&gt;安装&lt;/h3&gt;
&lt;p&gt;安装包在dist/target目录中.具体安装方式可参考官方安装文档，但win下编译的代码在linux下使用会遇到问题：&lt;/p&gt;

&lt;p&gt;tar.gz包传到linux上后解压，配置完毕，运行bin目录下的shell脚本，terminal提示
&lt;strong&gt;no such file or direcotory&lt;/strong&gt; 。&lt;/p&gt;

&lt;p&gt;这是由于这些shell脚本都是dos格式，不是unix格式，可vim打开后，通过 :set ff，
查看文件格式，把这些shell脚本转为unix格式，问题解决。&lt;/p&gt;

&lt;p&gt;可执行命令dos2unix，完成转换. linux下需要安装了该命令才能使用，win下git的
bash自带该命令，估计cygwin也有这个命令。解决该问题后可成功启动sqoop2-server.&lt;/p&gt;
</description>
        <pubDate>Fri, 21 Aug 2015 12:47:00 +0800</pubDate>
        <link>http://sleefd.github.io/newblog/bigdata/2015/08/21/sqoop-compile.html</link>
        <guid isPermaLink="true">http://sleefd.github.io/newblog/bigdata/2015/08/21/sqoop-compile.html</guid>
        
        
        <category>bigdata</category>
        
      </item>
    
      <item>
        <title>git相关操作</title>
        <description>&lt;p&gt;平时自用git涉及不到什么高级的用法，因为也就一个人开发。
最近工作上用gerrit提交代码, 遇到很多问题, 发现对git的有些
操作并不了解，现总结一些问题及命令如下：&lt;/p&gt;

&lt;h3 id=&quot;pullgit-review-pullpush&quot;&gt;每次提交代码都应该先pull，再git review; 或者先pull，再push&lt;/h3&gt;
&lt;p&gt;pull保证本地代码与remote一致，再push自己本地的修改到remote,这样不会有冲突。&lt;/p&gt;

&lt;p&gt;直接push很可能有冲突。&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;git pull origin master
&lt;span class=&quot;c&quot;&gt;### other operations&lt;/span&gt;
git push origin master&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;git-commit---amend-amend&quot;&gt;git commit –amend, amend上一次提交，不会产生新提交&lt;/h3&gt;
&lt;p&gt;可用于重新修改comment，或修改上一次提交的文件内容，只是再次commit
时要加上–amend选项。&lt;/p&gt;

&lt;h3 id=&quot;git-add&quot;&gt;丢弃git add到暂存区的文件修改&lt;/h3&gt;

&lt;p&gt;有三种方法，一是在原文件上修改后重新add，staged的相同文件就会被覆盖;&lt;/p&gt;

&lt;p&gt;另一种方法是reset head;&lt;/p&gt;

&lt;p&gt;还可以重新checkout该文件，那么工作区中该文件就会回到未修改之前的状态，再在上面做修改后add.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;git reset head filename &lt;span class=&quot;c&quot;&gt;## unstaged filename&lt;/span&gt;
git reset head &lt;span class=&quot;c&quot;&gt;# unstaged all the files&lt;/span&gt;
git checkout -- filename &lt;span class=&quot;c&quot;&gt;# reset file in the workspace&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;git-reset-&quot;&gt;git reset, 重置到某次提交&lt;/h3&gt;
&lt;p&gt;提交多次后，想回到某次提交的状态，可以使用reset，
reset之后，该次提交之后的所有提交都木有了。&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;# reset to last second commit,&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# all the modified in head return to workspace&lt;/span&gt;
git reset head~1 

&lt;span class=&quot;c&quot;&gt;# reset to last second commit,all the modified are discarded&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# workspce is clean&lt;/span&gt;
git reset head~1 --hard&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;git-revert-commit-revertcommit&quot;&gt;git revert commit, revert某次commit&lt;/h3&gt;

&lt;p&gt;会产生一次新的提交，新的提交重置commit的内容&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;# revert head, produce a new commit &amp;quot;revert&amp;quot;&lt;/span&gt;
git revert head  

&lt;span class=&quot;c&quot;&gt;#git revert commit of SHA&lt;/span&gt;
git revert COMMIT_SHA&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;git-stashclean&quot;&gt;git stash可缓存工作区的内容到一个栈中，让工作区恢复到clean状态&lt;/h3&gt;

&lt;p&gt;可通过git stash apply或git stash pop来恢复最后被暂存的东西（位于栈顶）。&lt;/p&gt;

&lt;p&gt;注意untrack的文件还在workspace中。&lt;/p&gt;

&lt;p&gt;当需要从一个分支切换到另一个分支而有不想commit当前工作内容，可以先stash，
然后切换分支。&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;git stash
git checkout master 
&lt;span class=&quot;c&quot;&gt;### do sth&lt;/span&gt;
git checkout dev
git stash apply &lt;span class=&quot;c&quot;&gt;# get back what u are doing &lt;/span&gt;

git stash list &lt;span class=&quot;c&quot;&gt;# review all the stashed content&lt;/span&gt;
git stash apply stash@&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;2&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;#choose last second stash apply&lt;/span&gt;
git stash pop &lt;span class=&quot;c&quot;&gt;#apply stash and remove the stash from stash list&lt;/span&gt;
git stash clear &lt;span class=&quot;c&quot;&gt;#clear stashes in stash list&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;rebasemastercommitreview&quot;&gt;新特性在分支开发，开发完毕后，rebase到master，可保证分支的每次commit，都可以review&lt;/h3&gt;

&lt;p&gt;对于较复杂的feature开发，肯定会有多次commit，gerrit分支上的每次commit也会产生changeID, 分支rebase到最新的master,
然后git review，会把所有逻辑化的commit按顺序提交到gerrit进行review,
并且rebase后master的commit历史是线性的不会出现分叉。&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;git pull origin master &lt;span class=&quot;c&quot;&gt;# update master &lt;/span&gt;

git checkout -b feature
&lt;span class=&quot;c&quot;&gt;## multiple times modify or add &lt;/span&gt;
git add 
git commit  

git rebase master &lt;span class=&quot;c&quot;&gt;##fast merge or fix confilcts&lt;/span&gt;
git checkout master
git merge feature&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;mergepullrebase-&quot;&gt;冲突解决，merge、pull、rebase都可能会有冲突， 冲突解决之后，才能继续操作&lt;/h3&gt;

&lt;p&gt;出现冲突，可先用git status查看有哪些文件冲突，然后一次修改这些文件。&lt;/p&gt;

&lt;p&gt;冲突的地方在«« 与 »»之间，中间由=====分隔开，上下分别代表不同commit的修改内容。&lt;/p&gt;

&lt;p&gt;解决冲突可采取接纳你的代码或其他人的代码或合并的方式，解决完之后重新commit.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;git status  &lt;span class=&quot;c&quot;&gt;### check unmerged conflict files&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;### fix conflicts&lt;/span&gt;
git add .  &lt;span class=&quot;c&quot;&gt;### stage modified files&lt;/span&gt;
git commit -m &lt;span class=&quot;s2&quot;&gt;&amp;quot;fix conflicts&amp;quot;&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;## commit, fix conflicts over&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;git-detached-head&quot;&gt;git detached head&lt;/h3&gt;

&lt;p&gt;出现detached head是由于checkout了非head的commit，
git checkout master后就没有了&lt;/p&gt;

&lt;h3 id=&quot;git-rebase--i&quot;&gt;git rebase -i,交互式变基，非常强大的功能&lt;/h3&gt;
&lt;p&gt;可重新组织commit的提交顺序，修改commit，拆分commit，
目前只会简单使用。&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;git rebase -i commit &lt;span class=&quot;c&quot;&gt;## appear a vim editor contains all the commits after the commit&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;### do some edit, modify pick to edit，you can edit the commit &lt;/span&gt;
git rebase --continue &lt;span class=&quot;c&quot;&gt;## continue rebase, until end the rebase&lt;/span&gt;
git rebase --abort &lt;span class=&quot;c&quot;&gt;## abort rebase, all the ops are canceled&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

</description>
        <pubDate>Thu, 20 Aug 2015 16:37:00 +0800</pubDate>
        <link>http://sleefd.github.io/newblog/learn/2015/08/20/git-related.html</link>
        <guid isPermaLink="true">http://sleefd.github.io/newblog/learn/2015/08/20/git-related.html</guid>
        
        
        <category>learn</category>
        
      </item>
    
      <item>
        <title>ajax总是调用error handle</title>
        <description>&lt;p&gt;做进度条展示状态遇到一个问题:发一个ajax请求，轮询后台状态，如果后台
出现异常，在error回调中clearTimeout,结果error总是被调用，轮询总是
被终止。&lt;/p&gt;

&lt;p&gt;浏览器调试，network请求显示成功，服务端spring controller也没出现任何
错误或异常，但前端error总是被call。查stackoverflow发现是dataType问题。&lt;/p&gt;

&lt;p&gt;ajax期望返回的是json数据，但spring controller返回void，response什么
也没有，response与期望返回类型不一致导致always error，ajax 去掉dataType
设置，让浏览器自行推断类型，就没有问题了。&lt;/p&gt;

</description>
        <pubDate>Sun, 05 Jul 2015 13:04:00 +0800</pubDate>
        <link>http://sleefd.github.io/newblog/front-end/2015/07/05/ajax-always-fail.html</link>
        <guid isPermaLink="true">http://sleefd.github.io/newblog/front-end/2015/07/05/ajax-always-fail.html</guid>
        
        
        <category>front-end</category>
        
      </item>
    
  </channel>
</rss>
